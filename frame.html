<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Frame test parent</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
  <h3>Frame parent - test iframe</h3>

  <p>Cette page est chargée si l'iframe dans le mail est évaluée. Elle effectue plusieurs requetes pour que tu puisses logger les hits serveur.</p>

  <ul>
    <li>Hit image directe : <img src=https://raw.githubusercontent.com/ameqdc/TestBL/refs/heads/main/ok.png?run=frame-parent-1" width="1" height="1" alt=""></li>
    <li>Hit CSS : <link rel="stylesheet" href="https://raw.githubusercontent.com/ameqdc/TestBL/refs/heads/main/test.css?run=frame-parent-css"></li>
    <li>Hit JSON via fetch (sera visible côté serveur si ton endpoint loggue les requetes) :</li>
  </ul>

  <script>
    // fetch vers un endpoint pour logger ; certains clients mail peuvent bloquer l'execution JS,
    // mais si la page est ouverte dans un navigateur (ou OWA), tu verras cette requete
    (function(){
      try {
        fetch('https://raw.githubusercontent.com/ameqdc/TestBL/refs/heads/main/blank.json?run=frame-parent-fetch', {method:'GET', credentials:'omit'})
          .catch(()=>{ /* silent */ });
      } catch(e) { /* silent */ }
    })();
  </script>

  <p>Iframe embarque le contenu réel :</p>
  <iframe src="https://raw.githubusercontent.com/ameqdc/TestBL/refs/heads/main/frame_content.html?run=frame-child-1" width="100%" height="240" title="frame-child"></iframe>

  <p>Test redirect iframe (le chemin /redirect-frame renverra un 302 vers frame_content.html)</p>
  <iframe src="https://raw.githubusercontent.com/ameqdc/TestBL/refs/heads/main/redirect-frame?run=frame-redirect-1" width="100%" height="120"></iframe>

  <hr>
  <p>Note : Outlook desktop peut ignorer les iframes dans le rendu mail. OWA et les navigateurs afficheront en revanche la page et généreront les hits.</p>
</body>
</html>
